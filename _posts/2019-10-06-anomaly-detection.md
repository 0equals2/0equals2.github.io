---
layout: post
title: "[Machine Learning] 이상 탐지"
excerpt: "anomaly detection"
categories: ds
tags: ml
---





이상탐지 : anomaly detection

정상의 반대 개념으로 정상에 대한 개념부터 정의해야 한다. 정상에 대한 개념은 분야 및 문제에 따라 다르게 정의될 수 있기 때문에 이상에 대한 개념 역시 다르게 정의된다.

Classification 은 두 범주를 구분할 수 있는 경계면을 찾는 것 

anomaly detection은 다수 범주를 고려하며 이상치가 아닌 데이터들의 sector를 구분 짓는 것

이상값은 자료 내 잘 정의된 정상적인 패턴을 따르지 않는 개체를 말한다. 먼저 자료 내 대부분의 점을 포함하는 두 정상 영역이 있고 정상 영역에서 멀리 떨어진 점과 이에 포함되지 않고 작은 영역 내 점들이 이상값

잡음제거 : 분석전 불필요한 객체 또는 성분을 없애는 목적

잡음조정 : 통계적 모형 추정에서 이상값의 영향을 줄이기 위한 것

신상탐지 : 지금까지 발견되지 않았던 새로운 패턴을 찾아내는 것 (즉, 패턴이 정상에 포함된다)

이상탐지 : 

이상탐지의 여러 요소

입력 자료의 성질 : 대부분 통계 모형은 연속형이나 범주형 자료에만 적용가능, KNN기반 기법들은 자료 객체 간 거리의 정의가 추가적으로 필요하다. 특히 자료의 실제 값 대신 거리 행렬이나 유사도 행렬과 같은 형태로 자료 객체 간 거리만 주어지는 경우에는 원래의 자료값이 필요한 대부분의 통꼐적 기법들을 적용하기 어렵다. 


 이상의 종류 1) 점이상 2) 맥락적 이상 (시계열)

 

자료라벨 라벨은 자료 개체의 이상 여부를 나타낸다. 전체 학습 자료에 정확히 이상 여부에 대한 라벨을 부여하는 것은 엄청난 노력과 비용이 발생,

지도 이상 탐지(supervised anomaly detection)

모든 개체의 라벨이 있을 때, 정상/ 이상 > 정확한 분류가 어렵다

준지도 이상 탐지 (semi-supervied anomaly detection) 

비지도 이상 탐지 (unsupervised anomaly detection)

 

출력값 1) 크기 순서가 있는 이상 점수, 경계를 분석자가 설정

2) 라벨을 부여, 모형의 모수 또는 초모수 값의 조정을 통해 간접적으로 비정상과 정상의 경계를 바꿀 수 있음

 

이상탐지 기법

\1. 분류기반 이상 탐지 기법 어느 클래스에 속하는지에 대한 라벨일 붙어 있는 자료로 분류기를 학습한 뒤, 각 클래스에 속할 확률 예측 (일집단과 다집단이 있음)

​                  가. 신경망 기반 (다집단, 일집단) 뛰어난 성능의 기계필요

​                  나. 베이지만 네트워크 기반 (다집단) 

​                  다. SVM (일집단) 2차 최적화가 필요, 느림. But 테스트 빠름

​                  라. 결정 규칙 기반 (일집단, 다집단) 속도가 빠르다

\2. NN 기반 이상 탐지 기법

정상값들이 몰려 있을 것이고 이상 값은 멀리 떨어져 있을 것. 자료 수가 많아지면 오래 걸림.

​                  가. KNN 비지도 학습기반. 

​                  나. 상대 밀도 이용 

군집화 기반 이상 탐지 기법 이상값이 군집을 이루면 극도록 취약해짐.

​                  가. 근본 가정에 따른 군집화 기반 이상 탐지 기법 : 1번 그룹은 정상값들은 하나 또는 몇 개의 군집에 모여 있고, 이상값은 군집에 속하지 않는다. DBSCAN, SNN, ROCK 등

​                  나. 군집의 중심 중 가장 가까운 것과의 거리가 짧으면 정상, 길면 이상값 kmeans, EM알고리즘. 빠름.

 

 

딥러닝 : t-SNE, KL발산