---
layout: post
title: "[MS-SQL] 02. SSMS"
excerpt: "introduction to SSMS"
categories: db
tags: sql
---

# SSMS : 엔진 아닌 툴

SQL Server 관리 : 서버 설정 변경, DB 생성, 테이블 생성, 보안(계정설정, 권한), 백업 / 복원

개발 : 스토어 프로시져, 트리거



## 사용법

개체 탐색기 : 서버, 보안, 관리, 에이전트 등등을 확인할 수 있다. 그 중 데이터베이스를 주로 사용.

데이터베이스 생성 : 데이터베이스 폴더를 클릭하고 오른쪽 버튼 + 새로 만들기 (여러 개의 서버를 이용할 수도 있다.)

query :새쿼리를 눌러서 쿼리입력창에 명령을 입력하면, 원하는 정보를 찾아낼 수 있다.

주의 사항! db가 선택이 안되어 있으면 에러 발생. 만약 안되어 있다면 USE 'db name' + GO

퀴리문 실행 F5

쿼리문 중 일부만 실행하고 싶으면, 해당 영역을 드래그 한 후 F5

결과값을 텍스트로 보고 싶으면, 상단 바의 텍스트로 결과 표시 선택



### 편의 기능들 

> 인텔리센스(intelliSense)기능 : 일부분만 입력해도 해당하는 목록을 자동 완성해주는 기능
>
> 드래그 드롭 기능: 원하는 칼럼, 필드명 따위를 끌고 올 수 있다.
>
> 대괄호 : 칼럼명, 필드명에 공백이 존재하면 []를 이용하여 오류를 방지할 수 있다.
>
> 한 줄이 끝났다는 의미 ;(세미콜론), GO
>
> 복잡한 쿼리는 기초 코드를 저장해두었다가 수정해서 사용(큰 프로젝트는 수백, 수천 줄의 sql문이 필요)
>
> 줄 번호 기능 : 도구 > 옵션 > 텍스트 편집기 > 모든 언어 > 일반 > 줄 번호 체크 (빠른 실행으로 '줄 번호' 검색하는 게 편리)
>
> 크기 조정 : CTRL + 마우스 휠
>
> 글꼴 : 도구 > 옵션 > 환경 > 글꼴 및 색 > 텍스트 편집기, 출력 창, 표 형태 결과 등을 변환 
>
> 텍스트 편집기를 상하, 좌우로 나눠서 볼 수 있음
>
> 매크로 기능 :  환경 > 키보드 > 쿼리 바로가기
>
> MS업데이트 : 도구 > 업데이트 확인 
>
> 상위 100개 행 : DB선택 후 오른쪽 버튼, 상위 100개 행 선택을 하면 자동으로 select문이 완성된다.



## 데이터 베이스

### 구조

데이터 베이스란?

>  데이터를 중앙에 모아 놓은 저장소
>
> 다중 사용자간의 데이터 공유
>
> 데이터 백업/ 복원
>
> 서버 이중화 (데이터 파손 대비)
>
> SQL 서버 설치 (엔진 설치 후 데이터를 넣기 위해) :
>
> * 데이터 베이스
>    * 테이블 생성
>       * 필드
>          * 타입
>          * 길이
>          * 제약 조건

어떤 구조로 되어 있는가? 

>* 순수 데이터 파일
>  * 테이블
>    * 필드
>
>* 로그 파일 : 어떤 처리의 중간단계, history를 보는 역할이 아닌 트랜젝션 처리를 위한 용도 (하나의 묶음 단위로 처리되어야 할 때, 예) 은행의 송금과 같은 처리)

### OLTP / OLAP

데이터 베이스의 사용 분야

* OLTP : online transaction Processing

  ​	실시간 실행

* OLAP : Online Analytical Processing

  ​	통계, 분석

  ​	Analysis Service / Reporting Service

쿼리문으로 하는 것은 대부분 OLTP라고 생각하면 됨



### System DB

유저가 만든 DB가 아닌 시스템이 제공하는 DB, 마스터 데이터 베이스에서 어디에 뭐가 저장되어 있는지 등을 확인할 수 있다.

전체 MS SQL를 관리해준다. 만약에 master db가 손상되면 MS SQL 자체를 사용할 수 없다.

tempdb : 껐다가 키면 모두 사라지는 임시 테이블

msdb : 자동화와 관련된 정보들이 저장되는 db

*** 우리가 절대 직접 만지지 않는다 ***



## 데이터베이스 구조

### 데이터베이스 생성

데이터 베이스의 확장자 . mdf , .ndf(나눠진 두 번째 파일부터)

로그 파일의 확장자 .ldf

이런 파일이 너무 많이 싸이기 때문에, 두 드라이브에 따로 저장하는 것이 좋다. (데이터 파일을 D드라이브에, 로그 데이터를 E드라이브에 저장하는 식) 왔다 갔다 읽기 때문에, 낭비되는 시간을 줄인다. SSD에서는 이런 문제가 훨씬 적기는 하지만, 따로 하는 것이 좋음.

페이지 : DB를 하나의 책이라고 생각하면, 테이블의 8k(1027 * 8 byte)가 페이지가 된다. 

익스텐트(Extents) : 8 페이지가 모여서 1 익스텐트가 된다. 



### 트랜잭션 로그 파일

작업 메모리의 중간단계 작업 로그

트랜잭션 시작 > 작업1, 작업2 , 작업3 > DB저장(commit) > 끝

작업들 사이에 오류가 발생할 경우, 롤백을 할 수 있게 도와주는 로그 파일

**주의사항** DB파일과 다른 디렉토리에 보관!

1. 속도
2. Risk

